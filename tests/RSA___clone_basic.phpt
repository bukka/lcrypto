--TEST--
RSA::__clone basic usage.
--SKIPIF--
<?php
if (!extension_loaded('lcrypto'))
	die("Skip: Low-level Crypto extension not loaded");
?>
--FILE--
<?php
require_once dirname(__FILE__) . "/rsa_keys.inc";

list($rsa, $ctext_ex) = rsa_test_key1();
$rsa_copy = clone $rsa;


echo "Original\n";
var_dump($rsa->getKey(LCrypto\RSA::ENCODING_HEX));
var_dump($rsa->getFactors(LCrypto\RSA::ENCODING_HEX));
var_dump($rsa->getCrtParams(LCrypto\RSA::ENCODING_HEX));
echo "Clone\n";
var_dump($rsa_copy->getKey(LCrypto\RSA::ENCODING_HEX));
var_dump($rsa_copy->getFactors(LCrypto\RSA::ENCODING_HEX));
var_dump($rsa_copy->getCrtParams(LCrypto\RSA::ENCODING_HEX));
?>
--EXPECT--
Original
array(3) {
  ["n"]=>
  string(128) "AA36ABCE88ACFDFF55523C7FC4523F90EFA00DF3774A259F2E62B4C5D99CB5ADB300A0285E5301930E0C70FB6876939CE616CE624A11E0086D341EBCACA0A1F5"
  ["e"]=>
  string(2) "11"
  ["d"]=>
  string(128) "0A033748626487695F5F30BC38B98B44C2CD2DFF434098CD20D8A138D090BF64797C3FA7A2CDCB3CD1E0BDBA2654B4F9DF8E8AE59D733D9F33B301624AFD1D51"
}
array(2) {
  ["p"]=>
  string(64) "D840B41666B42E92EA0DA3B43204B5CFCE3352524D0416A5A441E700AF46120D"
  ["q"]=>
  string(64) "C97FB1F027F453F6341233EAAAD1D9353F6C42D08866B1D05A0F2035028B9D89"
}
array(3) {
  ["dmp1"]=>
  string(64) "590B9572A2C2A9C406059DC2AB2F1DAFEB7E8B4F10A7549E8EEDF5B4FCE09E05"
  ["dmq1"]=>
  string(64) "8E3C0521FE15E0EA06A36FF0F10C9952C35B7A7514FD3238B80AAD5298628D51"
  ["iqmp"]=>
  string(64) "363FF7189DA8E90B1D341F71D09B76A8A943E11D10B24D249F2DEAFEF80C1826"
}
Clone
array(3) {
  ["n"]=>
  string(128) "AA36ABCE88ACFDFF55523C7FC4523F90EFA00DF3774A259F2E62B4C5D99CB5ADB300A0285E5301930E0C70FB6876939CE616CE624A11E0086D341EBCACA0A1F5"
  ["e"]=>
  string(2) "11"
  ["d"]=>
  string(128) "0A033748626487695F5F30BC38B98B44C2CD2DFF434098CD20D8A138D090BF64797C3FA7A2CDCB3CD1E0BDBA2654B4F9DF8E8AE59D733D9F33B301624AFD1D51"
}
array(2) {
  ["p"]=>
  string(64) "D840B41666B42E92EA0DA3B43204B5CFCE3352524D0416A5A441E700AF46120D"
  ["q"]=>
  string(64) "C97FB1F027F453F6341233EAAAD1D9353F6C42D08866B1D05A0F2035028B9D89"
}
array(3) {
  ["dmp1"]=>
  string(64) "590B9572A2C2A9C406059DC2AB2F1DAFEB7E8B4F10A7549E8EEDF5B4FCE09E05"
  ["dmq1"]=>
  string(64) "8E3C0521FE15E0EA06A36FF0F10C9952C35B7A7514FD3238B80AAD5298628D51"
  ["iqmp"]=>
  string(64) "363FF7189DA8E90B1D341F71D09B76A8A943E11D10B24D249F2DEAFEF80C1826"
}
